{"ast":null,"code":"var _jsxFileName = \"/Users/didaryilmaz/Documents/GitHub/YardimMasasi/yardim-masasi/src/context/AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null); // { name, role, token }\n  const navigate = useNavigate();\n  useEffect(() => {\n    // Sayfa yenilendiğinde localStorage'dan token varsa kullanıcıyı geri yükle\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      const decoded = jwtDecode(token);\n      const role = decoded[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"];\n      const name = localStorage.getItem(\"username\");\n      setUser({\n        name,\n        role,\n        token\n      });\n    }\n  }, []);\n  const login = (token, name) => {\n    const decoded = jwtDecode(token);\n    const role = decoded[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"];\n    console.log(\"Decoded role:\", role); // ← ekledik: rolü konsolda gör\n    localStorage.setItem(\"token\", token);\n    localStorage.setItem(\"username\", name);\n    localStorage.setItem(\"role\", role);\n    setUser({\n      name,\n      role,\n      token\n    });\n\n    // Yönlendirme rolüne göre\n    if (role === \"Admin\") {\n      navigate(\"/ticket-list\");\n    } else if (role === \"User\") {\n      navigate(\"/tickets\");\n    } else if (role === \"Support\") {\n      navigate(\"/support-dashboard\");\n    } else {\n      navigate(\"/\"); // ← sadece tanımsız roller için buraya gider\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"username\");\n    localStorage.removeItem(\"role\");\n    setUser(null);\n    navigate(\"/login\");\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      login,\n      logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n};\n\n// Custom hook\n_s(AuthProvider, \"/48TlfV0adSMEvsbW2gk5sMeopI=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","useNavigate","jwtDecode","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","navigate","token","localStorage","getItem","decoded","role","name","login","console","log","setItem","logout","removeItem","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","$RefreshReg$"],"sources":["/Users/didaryilmaz/Documents/GitHub/YardimMasasi/yardim-masasi/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jwtDecode } from \"jwt-decode\";\n\nconst AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null); // { name, role, token }\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // Sayfa yenilendiğinde localStorage'dan token varsa kullanıcıyı geri yükle\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      const decoded = jwtDecode(token);\n      const role =\n        decoded[\n          \"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"\n        ];\n      const name = localStorage.getItem(\"username\");\n\n      setUser({ name, role, token });\n    }\n  }, []);\n\n  const login = (token, name) => {\n  const decoded = jwtDecode(token);\n  const role =\n    decoded[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"];\n\n  console.log(\"Decoded role:\", role); // ← ekledik: rolü konsolda gör\n  localStorage.setItem(\"token\", token);\n  localStorage.setItem(\"username\", name);\n  localStorage.setItem(\"role\", role);\n\n  setUser({ name, role, token });\n\n  // Yönlendirme rolüne göre\n  if (role === \"Admin\") {\n    navigate(\"/ticket-list\");\n  } else if (role === \"User\") {\n    navigate(\"/tickets\");\n  } else if (role === \"Support\") {\n    navigate(\"/support-dashboard\");\n  } else {\n    navigate(\"/\"); // ← sadece tanımsız roller için buraya gider\n  }\n};\n\n\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"username\");\n    localStorage.removeItem(\"role\");\n    setUser(null);\n    navigate(\"/login\");\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, login, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\n// Custom hook\nexport const useAuth = () => useContext(AuthContext);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}