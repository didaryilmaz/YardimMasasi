{"ast":null,"code":"var _jsxFileName = \"/Users/didaryilmaz/Documents/GitHub/YardimMasasi/yardim-masasi/src/TicketResponse.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\nimport MessageBubble from './Components/MessageBubble';\nimport ResponseBox from './Components/ResponseBox';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TicketResponse = () => {\n  _s();\n  var _ticket$status;\n  const {\n    ticketId\n  } = useParams();\n  const [ticket, setTicket] = useState(null);\n  const [responses, setResponses] = useState([]);\n  const [responseText, setResponseText] = useState('');\n  const [loadingResponse, setLoadingResponse] = useState(false);\n  const [isSupportUser, setIsSupportUser] = useState(false);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const headers = {\n          Authorization: `Bearer ${token}`\n        };\n        const ticketRes = await axios.get(`http://localhost:5094/api/ticket/${ticketId}`, {\n          headers\n        });\n        setTicket(ticketRes.data);\n        await fetchResponses(token);\n        const userRole = localStorage.getItem('role');\n        setIsSupportUser((userRole === null || userRole === void 0 ? void 0 : userRole.toLowerCase()) === 'support');\n      } catch (error) {\n        console.error('Veriler alınamadı:', error);\n      }\n    };\n    fetchData();\n  }, [ticketId]);\n  const fetchResponses = async token => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${token}`\n      };\n      const responseRes = await axios.get(`http://localhost:5094/api/ticket/${ticketId}/responses`, {\n        headers\n      });\n      setResponses(responseRes.data);\n    } catch (error) {\n      console.error('Yanıtlar alınamadı:', error);\n    }\n  };\n  const handleSubmitResponse = async () => {\n    if (!responseText.trim()) return;\n    try {\n      setLoadingResponse(true);\n      const token = localStorage.getItem('token');\n      const headers = {\n        Authorization: `Bearer ${token}`\n      };\n      const res = await axios.post(`http://localhost:5094/api/ticket/${ticketId}/responses`, {\n        response: responseText\n      }, {\n        headers\n      });\n      setResponses(prev => [...prev, res.data]);\n      setResponseText('');\n    } catch (error) {\n      console.error('Yanıt gönderilemedi:', error);\n    } finally {\n      setLoadingResponse(false);\n    }\n  };\n  if (!ticket) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Y\\xFCkleniyor...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ticket-chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: ticket.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-box\",\n      children: responses.map((res, index) => /*#__PURE__*/_jsxDEV(MessageBubble, {\n        isOwnMessage: isSupportUser ? res.userRole !== 'support' : res.userRole === 'support',\n        message: res.response,\n        timestamp: res.dateTime\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), (isSupportUser || (ticket === null || ticket === void 0 ? void 0 : (_ticket$status = ticket.status) === null || _ticket$status === void 0 ? void 0 : _ticket$status.toLowerCase()) === 'açık') && /*#__PURE__*/_jsxDEV(ResponseBox, {\n      onSubmit: handleSubmitResponse,\n      value: responseText,\n      onChange: e => setResponseText(e.target.value),\n      disabled: loadingResponse\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n_s(TicketResponse, \"xxEs6SVVOqtR1ApwkdmB6J+qElA=\", false, function () {\n  return [useParams];\n});\n_c = TicketResponse;\nexport default TicketResponse;\nvar _c;\n$RefreshReg$(_c, \"TicketResponse\");","map":{"version":3,"names":["React","useEffect","useState","axios","useParams","MessageBubble","ResponseBox","jsxDEV","_jsxDEV","TicketResponse","_s","_ticket$status","ticketId","ticket","setTicket","responses","setResponses","responseText","setResponseText","loadingResponse","setLoadingResponse","isSupportUser","setIsSupportUser","fetchData","token","localStorage","getItem","headers","Authorization","ticketRes","get","data","fetchResponses","userRole","toLowerCase","error","console","responseRes","handleSubmitResponse","trim","res","post","response","prev","children","fileName","_jsxFileName","lineNumber","columnNumber","className","title","map","index","isOwnMessage","message","timestamp","dateTime","status","onSubmit","value","onChange","e","target","disabled","_c","$RefreshReg$"],"sources":["/Users/didaryilmaz/Documents/GitHub/YardimMasasi/yardim-masasi/src/TicketResponse.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\nimport MessageBubble from './Components/MessageBubble';\nimport ResponseBox from './Components/ResponseBox';\n\nconst TicketResponse = () => {\n  const { ticketId } = useParams();\n\n  const [ticket, setTicket] = useState(null);\n  const [responses, setResponses] = useState([]);\n  const [responseText, setResponseText] = useState('');\n  const [loadingResponse, setLoadingResponse] = useState(false);\n  const [isSupportUser, setIsSupportUser] = useState(false);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const headers = { Authorization: `Bearer ${token}` };\n\n        const ticketRes = await axios.get(`http://localhost:5094/api/ticket/${ticketId}`, { headers });\n        setTicket(ticketRes.data);\n\n        await fetchResponses(token);\n\n        const userRole = localStorage.getItem('role');\n        setIsSupportUser(userRole?.toLowerCase() === 'support');\n      } catch (error) {\n        console.error('Veriler alınamadı:', error);\n      }\n    };\n\n    fetchData();\n  }, [ticketId]);\n\n  const fetchResponses = async (token) => {\n    try {\n      const headers = { Authorization: `Bearer ${token}` };\n      const responseRes = await axios.get(`http://localhost:5094/api/ticket/${ticketId}/responses`, { headers });\n      setResponses(responseRes.data);\n    } catch (error) {\n      console.error('Yanıtlar alınamadı:', error);\n    }\n  };\n\n  const handleSubmitResponse = async () => {\n    if (!responseText.trim()) return;\n\n    try {\n      setLoadingResponse(true);\n      const token = localStorage.getItem('token');\n      const headers = { Authorization: `Bearer ${token}` };\n\n      const res = await axios.post(\n        `http://localhost:5094/api/ticket/${ticketId}/responses`,\n        { response: responseText },\n        { headers }\n      );\n\n      setResponses((prev) => [...prev, res.data]);\n      setResponseText('');\n    } catch (error) {\n      console.error('Yanıt gönderilemedi:', error);\n    } finally {\n      setLoadingResponse(false);\n    }\n  };\n\n  if (!ticket) return <div>Yükleniyor...</div>;\n\n  return (\n    <div className=\"ticket-chat-container\">\n      <h2>{ticket.title}</h2>\n      <div className=\"chat-box\">\n        {responses.map((res, index) => (\n          <MessageBubble\n            key={index}\n            isOwnMessage={isSupportUser ? res.userRole !== 'support' : res.userRole === 'support'}\n            message={res.response}\n            timestamp={res.dateTime}\n          />\n        ))}\n      </div>\n\n      {(isSupportUser || ticket?.status?.toLowerCase() === 'açık') && (\n        <ResponseBox\n          onSubmit={handleSubmitResponse}\n          value={responseText}\n          onChange={(e) => setResponseText(e.target.value)}\n          disabled={loadingResponse}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default TicketResponse;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}